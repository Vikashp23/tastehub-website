<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>TasteHub | Kannuru Nearby Only ‚Äì Menu & Order</title>
<meta name="description" content="TasteHub ‚Äì Homemade Veg Meals near Kannuru. View menu, add to cart, checkout on WhatsApp." />

<style>
  :root{
    --bg:#0b0f14; --surface:#121824; --card:#151e2d;
    --stroke:rgba(255,255,255,.10);
    --text:#f6f7fb; --muted:rgba(246,247,251,.72);
    --brand:#20c997; --danger:#ff4d4f; --warn:#ffb020;
    --shadow: 0 18px 60px rgba(0,0,0,.55);
    --r:18px; --r2:24px; --max:1120px;
  }
  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
    color:var(--text);
    background:
      radial-gradient(1200px 700px at 15% -10%, rgba(32,201,151,.20), transparent 55%),
      radial-gradient(900px 600px at 95% 0%, rgba(255,77,79,.12), transparent 55%),
      linear-gradient(180deg, #080b10, #0b0f14 55%, #080b10);
    min-height:100vh;
  }
  a{color:inherit}
  .wrap{max-width:var(--max); margin:0 auto; padding:16px 14px 120px;}
  .appbar{
    position:sticky; top:0; z-index:20;
    background: rgba(11,15,20,.78);
    backdrop-filter: blur(10px);
    border-bottom:1px solid rgba(255,255,255,.07);
  }
  .appbarInner{
    max-width:var(--max); margin:0 auto;
    padding:12px 14px;
    display:flex; gap:12px; align-items:center; justify-content:space-between;
  }
  .brandRow{display:flex; gap:10px; align-items:center; min-width:0;}
  .logo{
    width:44px; height:44px; border-radius:14px;
    background: linear-gradient(135deg, rgba(32,201,151,.95), rgba(32,201,151,.45));
    display:grid; place-items:center;
    color:#052015; font-weight:1000;
    overflow:hidden; border:1px solid rgba(255,255,255,.12);
    flex:0 0 auto; position:relative;
  }
  .logo img{width:100%; height:100%; object-fit:cover; display:none;}
  .logo span{position:absolute; inset:0; display:grid; place-items:center;}
  .bt{min-width:0}
  .bt h1{margin:0; font-size:16px; letter-spacing:-.01em; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
  .bt p{margin:2px 0 0; font-size:12px; color:var(--muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
  .chipRow{display:flex; gap:8px; flex-wrap:wrap; justify-content:flex-end; align-items:center;}
  .chip{
    font-size:12px; font-weight:800;
    padding:7px 10px; border-radius:999px;
    background: rgba(255,255,255,.06);
    border:1px solid rgba(255,255,255,.10);
    color:rgba(246,247,251,.90);
    white-space:nowrap;
  }
  .chip.green{background: rgba(32,201,151,.12); border-color: rgba(32,201,151,.25); color:#caffef;}
  .hero{margin-top:14px; display:grid; grid-template-columns: 1.25fr .75fr; gap:14px;}
  @media (max-width: 900px){ .hero{grid-template-columns:1fr;} }
  .panel{
    background: rgba(18,24,36,.70);
    border:1px solid rgba(255,255,255,.10);
    border-radius: var(--r2);
    box-shadow: var(--shadow);
    overflow:hidden;
  }
  .pad{padding:14px;}
  .titleRow{display:flex; align-items:flex-start; justify-content:space-between; gap:10px; flex-wrap:wrap;}
  .titleRow h2{margin:0; font-size:15px; letter-spacing:-.01em;}
  .sub{margin:6px 0 0; color:var(--muted); font-size:13px; line-height:1.35;}
  .tabs{
    display:flex; gap:10px; overflow:auto; padding:12px 14px;
    border-top:1px solid rgba(255,255,255,.06);
    border-bottom:1px solid rgba(255,255,255,.06);
    background: rgba(0,0,0,.18);
    scrollbar-width:none;
  }
  .tabs::-webkit-scrollbar{display:none}
  .tab{
    flex:0 0 auto;
    padding:9px 12px;
    border-radius:999px;
    border:1px solid rgba(255,255,255,.10);
    background: rgba(255,255,255,.06);
    color:rgba(246,247,251,.92);
    font-weight:900;
    font-size:12px;
    cursor:pointer; user-select:none;
    transition:.15s transform ease, .15s background ease;
  }
  .tab:hover{transform: translateY(-1px); background: rgba(255,255,255,.09);}
  .tab.active{background: rgba(32,201,151,.14); border-color: rgba(32,201,151,.28); color:#caffef;}

  .sectionTitle{margin:10px 0 0; padding:0 14px 6px; font-size:12px; color:rgba(246,247,251,.65);
    text-transform:uppercase; letter-spacing:.14em; font-weight:1000;}
  .sectionInfo{margin:0 14px 10px; font-size:12px; color: rgba(246,247,251,.70);}

  .menuGrid{display:grid; grid-template-columns: 1fr; gap:10px; padding:0 14px 14px;}
  .item{
    background: rgba(21,30,45,.75);
    border:1px solid rgba(255,255,255,.10);
    border-radius: var(--r);
    padding:12px;
    display:flex; gap:12px; align-items:flex-start; justify-content:space-between;
  }
  .iLeft{min-width:0;}
  .iTop{display:flex; gap:10px; align-items:center; flex-wrap:wrap;}
  .vegDot{width:10px; height:10px; border-radius:3px; border:1px solid rgba(32,201,151,.55);
    background: rgba(32,201,151,.25); box-shadow: 0 0 0 3px rgba(32,201,151,.08);}
  .iname{font-weight:1000; font-size:14px; letter-spacing:-.01em;}
  .iprice{font-weight:1000; font-size:13px; color:#d9ffe9;}
  .idesc{margin:6px 0 0; color:var(--muted); font-size:12.5px; line-height:1.35;}
  .iRight{display:flex; flex-direction:column; gap:8px; align-items:flex-end;}

  .qty{display:flex; gap:8px; align-items:center; padding:7px 10px; border-radius:12px;
    border:1px solid rgba(255,255,255,.12); background: rgba(0,0,0,.18);}
  .qbtn{width:28px; height:28px; border-radius:10px; border:1px solid rgba(255,255,255,.14);
    background: rgba(255,255,255,.06); color:var(--text); font-weight:1000; cursor:pointer;}
  .qnum{min-width:18px; text-align:center; font-weight:1000; font-size:13px;}
  .addBtn{padding:9px 12px; border-radius:12px; border:1px solid rgba(32,201,151,.30);
    background: rgba(32,201,151,.14); color:#caffef; font-weight:1000; font-size:12px; cursor:pointer; white-space:nowrap;}
  .addBtn.primary{background: linear-gradient(135deg, rgba(32,201,151,.95), rgba(32,201,151,.68)); border:none; color:#052015;}

  .emptyState{padding:16px; border-radius:18px; border:1px dashed rgba(255,255,255,.18);
    background: rgba(0,0,0,.14); color: rgba(246,247,251,.90);}
  .emptyTitle{ font-weight:1000; margin-bottom:6px; }
  .emptySub{ font-size:12px; color: rgba(246,247,251,.65); line-height:1.35; }

  .stack{display:grid; gap:12px;}
  .links{display:grid; gap:10px; margin-top:10px;}
  .linkBtn{display:flex; align-items:center; justify-content:space-between; gap:10px; padding:12px 12px;
    border-radius:16px; border:1px solid rgba(255,255,255,.12); background: rgba(255,255,255,.06);
    text-decoration:none; color:var(--text); transition: transform .12s ease, background .12s ease;}
  .linkBtn:hover{transform: translateY(-1px); background: rgba(255,255,255,.09);}
  .lL{display:flex; gap:10px; align-items:center; min-width:0;}
  .ic{width:34px; height:34px; border-radius:12px; display:grid; place-items:center; background: rgba(0,0,0,.22);
    border:1px solid rgba(255,255,255,.12); flex:0 0 auto;}
  .lt{min-width:0;}
  .lt .t{font-weight:1000; font-size:13px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
  .lt .s{font-size:12px; color:var(--muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
  .arr{opacity:.8; font-size:18px;}

  .cartBar{position:fixed; left:0; right:0; bottom:0; z-index:50; background: rgba(11,15,20,.88);
    backdrop-filter: blur(10px); border-top:1px solid rgba(255,255,255,.10);}
  .cartInner{max-width:var(--max); margin:0 auto; padding:12px 14px; display:flex; gap:12px; align-items:center; justify-content:space-between;}
  .cartLeft{min-width:0}
  .cartLeft .c1{font-weight:1000; font-size:14px; white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
  .cartLeft .c2{font-size:12px; color:var(--muted); white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}
  .checkoutBtn{padding:12px 14px; border-radius:14px; border:none;
    background: linear-gradient(135deg, rgba(32,201,151,.95), rgba(32,201,151,.70));
    color:#052015; font-weight:1100; cursor:pointer; white-space:nowrap;}
  .ghostBtn{padding:12px 12px; border-radius:14px; border:1px solid rgba(255,255,255,.14);
    background: rgba(255,255,255,.06); color:var(--text); font-weight:1000; cursor:pointer; white-space:nowrap;}

  .drawerOverlay{position:fixed; inset:0; z-index:60; background: rgba(0,0,0,.55); display:none;
    align-items:flex-end; justify-content:center; padding:14px;}
  .drawer{width:min(720px, 100%); background: rgba(18,24,36,.92); border:1px solid rgba(255,255,255,.10);
    border-radius: 24px; box-shadow: var(--shadow); overflow:hidden; max-height: 88vh; display:flex; flex-direction:column;}
  .drawerHead{padding:14px; display:flex; align-items:center; justify-content:space-between; gap:10px; border-bottom:1px solid rgba(255,255,255,.08);}
  .drawerHead h3{margin:0; font-size:15px;}
  .closeBtn{width:40px; height:40px; border-radius:14px; border:1px solid rgba(255,255,255,.14);
    background: rgba(255,255,255,.06); color:var(--text); font-weight:1000; cursor:pointer;}
  .drawerBody{padding:14px; overflow:auto;}
  .cartList{display:grid; gap:10px;}
  .cartItem{display:flex; align-items:center; justify-content:space-between; gap:12px;
    background: rgba(0,0,0,.18); border:1px solid rgba(255,255,255,.10); border-radius: 16px; padding:12px;}
  .cartItem .name{font-weight:1000; font-size:13px; margin:0 0 2px;}
  .cartItem .meta{font-size:12px; color:var(--muted);}
  .cartItem .right{display:flex; align-items:center; gap:10px;}
  .drawerFoot{padding:14px; border-top:1px solid rgba(255,255,255,.08); display:grid; gap:10px; background: rgba(0,0,0,.12);}
  .formGrid{display:grid; grid-template-columns:1fr 1fr; gap:10px;}
  @media (max-width: 560px){ .formGrid{grid-template-columns:1fr;} }
  label{font-size:12px; color:rgba(246,247,251,.78); font-weight:900;}
  input, textarea, select{width:100%; background: rgba(0,0,0,.18); border:1px solid rgba(255,255,255,.12);
    color:var(--text); border-radius:14px; padding:10px 12px; outline:none; font-size:14px;}
  textarea{min-height:80px; resize:vertical;}
  .mutedSmall{font-size:12px; color:rgba(246,247,251,.60); line-height:1.35;}

  /* Right-side floating social */
  .floatSocial{position:fixed; right:14px; top:110px; display:flex; flex-direction:column; gap:10px; z-index:80;}
  .floatBtn{width:46px; height:46px; border-radius:16px; border:1px solid rgba(255,255,255,.14);
    background: rgba(18,24,36,.75); backdrop-filter: blur(10px); display:grid; place-items:center;
    box-shadow: 0 10px 24px rgba(0,0,0,.35); text-decoration:none; font-weight:1000;}
</style>
</head>

<body>
  <div class="appbar">
    <div class="appbarInner">
      <div class="brandRow">
        <div class="logo" title="TasteHub">
          <span id="logoFallback">TH</span>
          <img id="logoImg" src="logo.png" alt="TasteHub logo">
        </div>
        <div class="bt">
          <h1>TasteHub ‚Äì Homemade Veg Meals</h1>
          <p>üìç Nearby Kannuru only ‚Ä¢ Kolte Patil Raaga & nearby apartments</p>
        </div>
      </div>

      <div class="chipRow">
        <span class="chip green" id="dateChip">Today</span>
        <span class="chip">100% Veg</span>
      </div>
    </div>
  </div>

  <!-- Right-side social buttons -->
  <div class="floatSocial" aria-label="Social links">
    <a class="floatBtn" href="https://www.instagram.com/tastehub_22/" target="_blank" rel="noopener" title="Instagram">üì∑</a>
    <a class="floatBtn" href="https://www.facebook.com/profile.php?id=61587586960844" target="_blank" rel="noopener" title="Facebook">f</a>
  </div>

  <div class="wrap">
    <div class="hero">
      <div class="panel">
        <div class="pad">
          <div class="titleRow">
            <h2>Menu</h2>
            <span class="chip green">Kannuru Nearby Only</span>
          </div>
          <p class="sub" id="menuNote">Add items to cart and checkout on WhatsApp. Items are visible all month; availability can be updated daily.</p>
        </div>

        <div class="tabs" id="tabs"></div>

        <div class="sectionTitle" id="sectionTitle">Items</div>
        <div class="sectionInfo" id="sectionInfo">Select a category.</div>
        <div class="menuGrid" id="menuGrid"></div>
      </div>

      <div class="stack">
        <div class="panel">
          <div class="pad">
            <div class="titleRow">
              <h2>Quick Links</h2>
              <span class="chip">Fast access</span>
            </div>

            <div class="links">
              <a class="linkBtn" href="https://wa.me/919632035612" target="_blank" rel="noopener">
                <div class="lL"><div class="ic">üí¨</div><div class="lt"><div class="t">WhatsApp Order</div><div class="s">Confirm items & timings</div></div></div>
                <div class="arr">‚Ä∫</div>
              </a>

              <a class="linkBtn" href="https://chat.whatsapp.com/JMvEqWg2awXGj2bXiMV9uD?mode=gi_t" target="_blank" rel="noopener">
                <div class="lL"><div class="ic">üë•</div><div class="lt"><div class="t">Join WhatsApp Group</div><div class="s">Daily menu & availability</div></div></div>
                <div class="arr">‚Ä∫</div>
              </a>

              <a class="linkBtn" href="https://maps.app.goo.gl/ZkxNT4HRU3ppFe65A" target="_blank" rel="noopener">
                <div class="lL"><div class="ic">üìç</div><div class="lt"><div class="t">Google Maps</div><div class="s">Kolte Patil Raaga, Kannuru</div></div></div>
                <div class="arr">‚Ä∫</div>
              </a>

              <a class="linkBtn" href="party.html">
                <div class="lL"><div class="ic">üéâ</div><div class="lt"><div class="t">Party / Bulk Order</div><div class="s">Custom menu + budget</div></div></div>
                <div class="arr">‚Ä∫</div>
              </a>
            </div>

            <div class="sub" style="margin-top:12px;">
              <b>Note:</b> If you want something custom for next day, please order prior on WhatsApp.
            </div>
          </div>
        </div>

        <div class="panel">
          <div class="pad">
            <div class="titleRow">
              <h2>Subscription Plans</h2>
              <span class="chip green">Flat 10% OFF</span>
            </div>
            <div class="sub" style="margin-top:8px;">
              ‚úî Daily Plan (10% OFF)<br/>
              ‚úî Weekly Plan (10% OFF)<br/>
              ‚úî Monthly Plan (priority + offers)<br/>
              üéâ Bulk / Party Orders ‚Äì custom menu
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>

  <div class="cartBar" id="cartBar" style="display:none;">
    <div class="cartInner">
      <div class="cartLeft">
        <div class="c1" id="cartSummary">0 items</div>
        <div class="c2" id="cartHint">Add items to checkout on WhatsApp</div>
      </div>
      <div style="display:flex; gap:10px; align-items:center;">
        <button class="ghostBtn" id="viewCartBtn">View Cart</button>
        <button class="checkoutBtn" id="checkoutBtn">Checkout</button>
      </div>
    </div>
  </div>

  <div class="drawerOverlay" id="drawerOverlay">
    <div class="drawer">
      <div class="drawerHead">
        <h3>Your Cart</h3>
        <button class="closeBtn" id="closeDrawer">‚úï</button>
      </div>

      <div class="drawerBody">
        <div class="cartList" id="cartList"></div>
      </div>

      <div class="drawerFoot">
        <div class="formGrid">
          <div><label for="custName">Name *</label><input id="custName" placeholder="Your name" /></div>
          <div><label for="custPhone">Phone (optional)</label><input id="custPhone" placeholder="10-digit number" inputmode="numeric" /></div>
        </div>

        <div class="formGrid">
          <div><label for="custFlat">Apartment / Flat *</label><input id="custFlat" placeholder="Raaga J1301 / Sobha City ..." /></div>
          <div>
            <label for="custTime">Preferred time</label>
            <select id="custTime">
              <option value="Breakfast">Breakfast</option>
              <option value="Lunch">Lunch</option>
              <option value="Snacks">Snacks</option>
              <option value="Dinner">Dinner</option>
              <option value="ASAP">ASAP</option>
            </select>
          </div>
        </div>

        <div><label for="custNotes">Notes (optional)</label><textarea id="custNotes" placeholder="Less spicy, no garlic, etc."></textarea></div>

        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <button class="ghostBtn" id="invoiceBtn">üßæ View Invoice</button>
          <button class="checkoutBtn" id="drawerCheckout">üì≤ Send Order on WhatsApp</button>
          <button class="ghostBtn" id="clearCart">Clear</button>
        </div>
        <div class="mutedSmall">Delivery (if needed) is self-booked by customer via Porter/Rapido/Uber.</div>
      </div>
    </div>
  </div>

<script>
  // ===== EDIT THESE ONLY =====
  const WHATSAPP_NUMBER = "919632035612";

  // Full Feb menu catalog (all items visible). You can later mark items available/unavailable from your scheduler.
  const MENU = {"breakfast": [], "lunch": [], "snacks": [], "dinner": []};

  // When a section is empty, show 4 suggestions.
  const SUGGESTIONS = {"breakfast": ["Poha", "Idli-Sambar", "Upma", "Paratha + Curd"], "lunch": ["Jeera Rice + Chhole", "Rajma Chawal", "Kadhi Chawal", "Paneer Sabzi + Paratha"], "snacks": ["Samosa + Chutney", "Onion Kachori", "Dahi Puri", "Pakoda + Chai"], "dinner": ["Litti Chokha", "Kadhai Paneer + Paratha", "Dal Fry + Jeera Rice", "Chana Ghugni + Paratha"]};

  // Invoice header details (FSSAI placeholder included)
  const INVOICE = {
    businessName: "TasteHub ‚Äì Homemade Veg Meals",
    serviceArea: "Nearby Kannuru / Kolte Patil Raaga only",
    address: "Kolte Patil Raaga, Kannuru, Bangalore",
    contact: "+91 96320 35612",
    cookedBy: "Neha Pathak",
    fssai: "XXXXXXXXXXXXXX"
  };
</script>

<script>
  // Logo fallback
  (function(){
    const img = document.getElementById('logoImg');
    const fb  = document.getElementById('logoFallback');
    img.onload = () => { img.style.display='block'; fb.style.display='none'; };
    img.onerror = () => { img.style.display='none'; fb.style.display='grid'; };
  })();

  // Date chip
  const d = new Date();
  document.getElementById('dateChip').textContent =
    d.toLocaleDateString('en-IN', { weekday:'short', day:'numeric', month:'short' });

  const sections = [
    {key:'breakfast', label:'Breakfast'},
    {key:'lunch', label:'Lunch'},
    {key:'snacks', label:'Snacks'},
    {key:'dinner', label:'Dinner'}
  ];

  const tabsEl = document.getElementById('tabs');
  const gridEl = document.getElementById('menuGrid');
  const sectionTitleEl = document.getElementById('sectionTitle');
  const sectionInfoEl = document.getElementById('sectionInfo');

  let activeKey = 'breakfast';

  function formatPrice(p){ return (!p || p<=0) ? "" : `‚Çπ${p}`; }

  const cart = new Map();
  function itemId(sectionKey, idx){ return `${sectionKey}:${idx}`; }
  function getCartQty(id){ return cart.has(id) ? cart.get(id).qty : 0; }

  function setQty(id, item, qty){
    if(qty <= 0) cart.delete(id);
    else cart.set(id, {item, qty});
    updateCartUI();
  }

  function renderTabs(){
    tabsEl.innerHTML = sections.map(s => {
      const active = s.key === activeKey ? "active" : "";
      return `<button class="tab ${active}" data-key="${s.key}">${s.label}</button>`;
    }).join('');
    tabsEl.querySelectorAll('.tab').forEach(b => {
      b.addEventListener('click', () => {
        activeKey = b.dataset.key;
        renderMenu(); renderTabs();
      });
    });
  }

  function renderMenu(){
    const items = MENU[activeKey] || [];
    sectionTitleEl.textContent = activeKey.toUpperCase();
    sectionInfoEl.textContent = "Tap ADD to build your order ‚Ä¢ For custom next-day items, please order prior on WhatsApp.";

    if(items.length === 0){
      const sugg = (SUGGESTIONS[activeKey] || []).slice(0,4);
      gridEl.innerHTML = `
        <div class="emptyState">
          <div class="emptyTitle">Not available right now</div>
          <div class="emptySub">We will update this section when menu is ready. Suggestions:</div>
          <div class="emptySub" style="margin-top:8px">‚Ä¢ ${sugg.join("<br/>‚Ä¢ ")}</div>
          <div class="emptySub" style="margin-top:10px">Join WhatsApp group for updates.</div>
        </div>
      `;
      return;
    }

    gridEl.innerHTML = items.map((it, idx) => {
      const id = itemId(activeKey, idx);
      const q = getCartQty(id);
      const price = formatPrice(it.price);

      const rightUI = (q > 0 ? `
          <div class="qty">
            <button class="qbtn" data-act="dec" data-id="${id}">‚àí</button>
            <div class="qnum">${q}</div>
            <button class="qbtn" data-act="inc" data-id="${id}">+</button>
          </div>
        ` : `<button class="addBtn primary" data-act="add" data-id="${id}">ADD</button>`);

      return `
        <div class="item">
          <div class="iLeft">
            <div class="iTop">
              <span class="vegDot" title="Veg"></span>
              <div class="iname">${it.name}</div>
            </div>
            <div class="iprice">${price}</div>
            ${it.desc ? `<div class="idesc">${it.desc}</div>` : ``}
          </div>
          <div class="iRight">${rightUI}</div>
        </div>
      `;
    }).join('');

    gridEl.querySelectorAll('[data-act]').forEach(el => {
      el.addEventListener('click', () => {
        const act = el.dataset.act;
        const id = el.dataset.id;
        const [sec, idxStr] = id.split(':');
        const item = MENU[sec][parseInt(idxStr, 10)];
        const cur = getCartQty(id);

        if(act === 'add') setQty(id, item, 1);
        if(act === 'inc') setQty(id, item, cur + 1);
        if(act === 'dec') setQty(id, item, cur - 1);

        renderMenu();
      });
    });
  }

  function cartTotals(){
    let count = 0, total = 0;
    cart.forEach(({
      item, qty
    }) => { count += qty; total += (item.price || 0) * qty; });
    return {count, total};
  }

  function updateCartUI(){
    const {count, total} = cartTotals();
    const bar = document.getElementById('cartBar');
    const summary = document.getElementById('cartSummary');

    if(count <= 0){ bar.style.display = 'none'; return; }
    bar.style.display = 'block';
    summary.textContent = `${count} item${count>1?'s':''}${total>0 ? ` ‚Ä¢ Total ‚Çπ${total}` : ''}`;
  }

  function openDrawer(){ document.getElementById('drawerOverlay').style.display = 'flex'; renderCartDrawer(); }
  function closeDrawer(){ document.getElementById('drawerOverlay').style.display = 'none'; }

  function renderCartDrawer(){
    const list = document.getElementById('cartList');
    if(cart.size === 0){ list.innerHTML = `<div class="mutedSmall">Your cart is empty.</div>`; return; }
    list.innerHTML = Array.from(cart.entries()).map(([id, v]) => {
      const {item, qty} = v;
      const price = item.price ? `‚Çπ${item.price}` : '';
      return `
        <div class="cartItem">
          <div>
            <div class="name">${item.name}</div>
            <div class="meta">${price} ${item.price ? '‚Ä¢' : ''} Qty: ${qty}</div>
          </div>
          <div class="right">
            <div class="qty">
              <button class="qbtn" data-cact="dec" data-id="${id}">‚àí</button>
              <div class="qnum">${qty}</div>
              <button class="qbtn" data-cact="inc" data-id="${id}">+</button>
            </div>
          </div>
        </div>
      `;
    }).join('');

    list.querySelectorAll('[data-cact]').forEach(el => {
      el.addEventListener('click', () => {
        const act = el.dataset.cact;
        const id = el.dataset.id;
        const cur = getCartQty(id);
        const entry = cart.get(id);
        if(!entry) return;
        const item = entry.item;
        if(act === 'inc') setQty(id, item, cur + 1);
        if(act === 'dec') setQty(id, item, cur - 1);
        renderCartDrawer(); renderMenu();
      });
    });
  }

  function buildWhatsAppText(){
    const name = document.getElementById('custName').value.trim();
    const phone = document.getElementById('custPhone').value.trim();
    const flat = document.getElementById('custFlat').value.trim();
    const time = document.getElementById('custTime').value;
    const notes = document.getElementById('custNotes').value.trim();

    const lines = [];
    cart.forEach(({item, qty}) => lines.push(`‚Ä¢ ${item.name} √ó ${qty}${item.price ? ` (‚Çπ${item.price})` : ''}`));

    const {total} = cartTotals();

    let msg = `Hi TasteHub üëã\n\nOrder Request (Kannuru Nearby)\n`;
    if(name) msg += `Name: ${name}\n`;
    if(phone) msg += `Phone: ${phone}\n`;
    if(flat) msg += `Apartment/Flat: ${flat}\n`;
    msg += `Preferred time: ${time}\n\n`;
    msg += `Items:\n${lines.join("\n")}\n`;
    if(total > 0) msg += `\nTotal (food only): ‚Çπ${total}\n`;
    if(notes) msg += `\nNotes: ${notes}\n`;
    msg += `\nCustom items for next day: Please order prior.\nThanks!`;
    return msg;
  }

  function checkoutOnWhatsApp(){
    const url = `https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(buildWhatsAppText())}`;
    window.open(url, "_blank");
  }

  function makeInvoiceNo(now){
    const pad = (n)=> String(n).padStart(2,'0');
    return `TH-${now.getFullYear()}${pad(now.getMonth()+1)}${pad(now.getDate())}-${pad(now.getHours())}${pad(now.getMinutes())}`;
  }

  function escapeHtml(s){
    return String(s ?? "").replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
  }

  function openInvoice(){
    const name = document.getElementById('custName').value.trim();
    const phone = document.getElementById('custPhone').value.trim();
    const flat = document.getElementById('custFlat').value.trim();
    const time = document.getElementById('custTime').value;
    const notes = document.getElementById('custNotes').value.trim();

    if(cart.size === 0){ alert("Your cart is empty."); return; }

    const now = new Date();
    const invNo = makeInvoiceNo(now);
    const invDate = now.toLocaleString('en-IN', { dateStyle:'medium', timeStyle:'short' });

    const rows = Array.from(cart.values()).map(({item, qty}) => {
      const line = (item.price || 0) * qty;
      return {name:item.name, qty, price:item.price||0, line};
    });
    const subtotal = rows.reduce((a,r)=>a+r.line,0);

    const html = `
<!doctype html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Invoice ${escapeHtml(invNo)}</title>
<style>
  :root{--text:#111;--muted:#555;--line:#e6e6e6;--brand:#0dbb86;}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:#f6f7fb;color:var(--text);}
  .wrap{max-width:820px;margin:0 auto;padding:18px;}
  .card{background:#fff;border:1px solid var(--line);border-radius:16px;box-shadow:0 12px 34px rgba(0,0,0,.08);overflow:hidden;}
  .head{padding:16px 18px;border-bottom:1px solid var(--line);display:flex;gap:14px;justify-content:space-between;flex-wrap:wrap;align-items:flex-start;}
  .brand{display:flex;gap:12px;align-items:center;}
  .logo{width:46px;height:46px;border-radius:14px;background:linear-gradient(135deg,#1fe0a7,#0dbb86);display:grid;place-items:center;color:#062016;font-weight:900;}
  h1{margin:0;font-size:18px;}
  .muted{color:var(--muted);font-size:12px;line-height:1.35;margin-top:4px}
  .meta{font-size:12px;color:var(--muted);text-align:right}
  .body{padding:16px 18px;}
  .grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;margin-bottom:14px}
  .box{border:1px solid var(--line);border-radius:14px;padding:12px}
  .box h3{margin:0 0 8px;font-size:13px}
  .box p{margin:0;font-size:12.5px;color:var(--muted);line-height:1.35}
  table{width:100%;border-collapse:collapse;border:1px solid var(--line);border-radius:14px;overflow:hidden}
  th,td{padding:10px 10px;border-bottom:1px solid var(--line);font-size:13px}
  th{background:#fafafa;text-align:left;font-size:12px;color:#444;text-transform:uppercase;letter-spacing:.06em}
  td.r{text-align:right}
  tfoot td{font-weight:800}
  .foot{padding:14px 18px;border-top:1px solid var(--line);display:flex;justify-content:space-between;gap:10px;flex-wrap:wrap;align-items:center}
  .btn{display:inline-flex;gap:8px;align-items:center;padding:10px 12px;border-radius:12px;border:1px solid var(--line);background:#fff;cursor:pointer;font-weight:800}
  .btn.primary{background:var(--brand);border:none;color:#062016}
  .note{font-size:12px;color:var(--muted)}
  @media print {.foot{display:none} body{background:#fff} .wrap{padding:0} .card{box-shadow:none;border:none}}
</style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <div class="head">
        <div class="brand">
          <div class="logo">TH</div>
          <div>
            <h1>${escapeHtml(INVOICE.businessName)}</h1>
            <div class="muted">
              ${escapeHtml(INVOICE.serviceArea)}<br/>
              ${escapeHtml(INVOICE.address)}<br/>
              Contact: ${escapeHtml(INVOICE.contact)} ‚Ä¢ Cooked by ${escapeHtml(INVOICE.cookedBy)}<br/>
              <b>FSSAI:</b> ${escapeHtml(INVOICE.fssai)}
            </div>
          </div>
        </div>
        <div class="meta">
          <div><b>Invoice:</b> ${escapeHtml(invNo)}</div>
          <div><b>Date:</b> ${escapeHtml(invDate)}</div>
        </div>
      </div>

      <div class="body">
        <div class="grid">
          <div class="box">
            <h3>Billed To</h3>
            <p><b>${escapeHtml(name || "Customer")}</b><br/>
            ${escapeHtml(flat || "Kannuru nearby")}<br/>
            ${phone ? ("Phone: " + escapeHtml(phone) + "<br/>") : ""}
            Time: ${escapeHtml(time)}</p>
          </div>
          <div class="box">
            <h3>Order Notes</h3>
            <p>${escapeHtml(notes || "‚Äî")}</p>
          </div>
        </div>

        <table>
          <thead>
            <tr>
              <th>Item</th>
              <th class="r">Qty</th>
              <th class="r">Price</th>
              <th class="r">Amount</th>
            </tr>
          </thead>
          <tbody>
            ${rows.map(r => `
              <tr>
                <td>${escapeHtml(r.name)}</td>
                <td class="r">${r.qty}</td>
                <td class="r">‚Çπ${r.price}</td>
                <td class="r">‚Çπ${r.line}</td>
              </tr>`).join("")}
          </tbody>
          <tfoot>
            <tr>
              <td colspan="3" class="r">Subtotal</td>
              <td class="r">‚Çπ${subtotal}</td>
            </tr>
          </tfoot>
        </table>

        <p class="note" style="margin:12px 0 0;">
          <b>Note:</b> This is a food-only invoice. Delivery cost (if any) is booked by customer via Porter/Rapido/Uber.
        </p>
      </div>

      <div class="foot">
        <div class="note">Print or ‚ÄúSave as PDF‚Äù from your browser.</div>
        <div style="display:flex; gap:10px; flex-wrap:wrap;">
          <button class="btn" onclick="window.print()">üñ®Ô∏è Print / Save PDF</button>
          <button class="btn primary" onclick="window.close()">Done</button>
        </div>
      </div>
    </div>
  </div>
</body>
</html>`;

    const w = window.open("", "_blank");
    if(!w){ alert("Popup blocked. Please allow popups to view invoice."); return; }
    w.document.open(); w.document.write(html); w.document.close();
  }

  document.getElementById('viewCartBtn').addEventListener('click', openDrawer);
  document.getElementById('checkoutBtn').addEventListener('click', openDrawer);
  document.getElementById('closeDrawer').addEventListener('click', closeDrawer);
  document.getElementById('drawerOverlay').addEventListener('click', (e) => { if(e.target.id === 'drawerOverlay') closeDrawer(); });

  document.getElementById('drawerCheckout').addEventListener('click', () => {
    const flat = document.getElementById('custFlat').value.trim();
    const name = document.getElementById('custName').value.trim();
    if(!name || !flat){ alert("Please enter Name and Apartment/Flat."); return; }
    if(cart.size === 0){ alert("Your cart is empty."); return; }
    checkoutOnWhatsApp();
  });

  document.getElementById('invoiceBtn').addEventListener('click', openInvoice);

  document.getElementById('clearCart').addEventListener('click', () => {
    cart.clear(); updateCartUI(); renderCartDrawer(); renderMenu();
  });

  renderTabs(); renderMenu(); updateCartUI();
</script>
</body>
</html>
